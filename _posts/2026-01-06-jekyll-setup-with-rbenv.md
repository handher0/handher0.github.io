---
layout: post
title: "Jekyll 블로그 구축기: 왜 rbenv로 환경을 격리해야 하는가?"
date: 2026-01-07 19:00:00 +0900
categories: [DevOps, Ruby]
tags: [Jekyll, rbenv, Bundler, Environment-Isolation]
toc: true
---

## 1. 서론: 왜 단순 설치가 아닌 '환경'을 고민했는가?

신입 백엔드/인프라 지망생으로서 블로그를 시작하며 가장 먼저 마주한 과제는 **'개발 환경 구축'**이었습니다. 단순히 `gem install jekyll`을 입력해 블로그를 띄울 수도 있었지만, 저는 이 과정에서 발생할 수 있는 의존성 충돌과 시스템 오염을 방지하기 위한 **공학적 접근**을 시도했습니다.

## 2. 문제 상황: Gem::FilePermissionError와의 조우

처음 Bundler를 설치하려 할 때 다음과 같은 에러를 마주했습니다.
`ERROR: While executing gem ... (Gem::FilePermissionError) You don't have write permissions for the /Library/Ruby/Gems/2.6.0 directory.`

### 왜 발생했는가? (Root Cause Analysis)
macOS에는 시스템 운영을 위한 **System Ruby**가 내장되어 있습니다. `/Library/Ruby/` 경로는 OS의 핵심 영역이므로 일반 사용자에게 쓰기 권한이 제한되어 있습니다. 여기서 많은 초보자가 `sudo`를 사용하여 강제로 설치하곤 합니다.

### 왜 `sudo`는 해결책이 아닌가?
인프라를 공부하는 입장에서 `sudo`를 통한 전역 설치는 두 가지 큰 리스크를 가집니다.
1. **시스템 오염:** OS가 사용하는 라이브러리와 내가 개발에 사용하는 라이브러리가 뒤섞여 예측 불가능한 시스템 오류를 야기할 수 있습니다.
2. **재현성 상실:** 내 컴퓨터에서는 `sudo`로 해결했지만, 다른 환경(서버, 팀원의 로컬)에서 똑같은 환경을 복제하기 어렵습니다.

## 3. 해결책: rbenv를 이용한 환경 격리

저는 이 문제를 해결하기 위해 Ruby 버전 관리 도구인 **rbenv**를 도입했습니다.



### rbenv의 동작 원리: Shim
rbenv는 `Shim`이라는 메커니즘을 사용합니다. 사용자가 `ruby`나 `gem` 명령어를 입력하면, 실제 시스템 경로가 아닌 rbenv가 생성한 가짜 경로(Shim)가 이를 가로채서 우리가 지정한 특정 버전의 루비를 실행해줍니다.

이를 통해 얻은 이득은 다음과 같습니다.
- **권한 격리:** 사용자 홈 디렉토리(`~/.rbenv`)에 루비를 설치하므로 `sudo`가 필요 없습니다.
- **버전 유연성:** 프로젝트별로 서로 다른 루비 버전을 사용할 수 있습니다.

## 4. 또 다른 복병: Bundler 버전 충돌

루비 환경을 격리한 후에도 `Could not find compatible versions for gem "bundler"` 에러가 발생했습니다. 이는 프로젝트의 `Gemfile`이 요구하는 버전(2.x)과 시스템의 최신 버전(4.x)이 일치하지 않아 발생한 **Semantic Versioning** 문제입니다.

### 의존성 관리의 핵심, Gemfile.lock
저는 이를 해결하기 위해 특정 버전을 지정하여 실행하거나, `bundle update --bundler`를 통해 프로젝트의 의존성 명세서를 갱신했습니다. 이 과정에서 `Gemfile.lock`이 단순한 로그 파일이 아니라, **"어느 환경에서든 동일한 실행을 보장하는 실행 계약서"**라는 점을 깊이 이해하게 되었습니다.

## 5. 마치며: 인프라 엔지니어의 자세

블로그 하나를 구축하는 과정이었지만, 그 안에는 **환경 격리, 권한 관리, 의존성 일관성**이라는 백엔드/인프라의 핵심 가치들이 녹아 있었습니다.

- **최소한의 기술 스택:** 화려한 프레임워크보다 문제 해결을 위한 최적의 도구(Hamilton Theme + rbenv)를 선택했습니다.
- **문제 해결 능력:** 에러 메시지 하나에서도 시스템 구조를 파악하고 근본적인 해결책을 찾으려 노력했습니다.

앞으로 이 블로그에는 단순한 기술 나열이 아닌, 이런 공학적 고민들을 담아낼 예정입니다.